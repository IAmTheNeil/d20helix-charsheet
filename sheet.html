<html>

<link rel="stylesheet" href="sheet.css">

<!-- NPC Toggle (The checkbox mustn't be within any tags in order for the ~ selector to properly hide all other elements) -->
<span class="npctoggle">Non-Player Character?</span>
<input type="checkbox" class="npctoggle" unchecked name="attr_char_isnpc"/>

<div class="sheetbody">

    <!-- Sheet Header -->

    <div class="header multicolumn">

        <ul>

            <li>
                <label>
                    Name
                    <br>
                    <input type="text" id="charname" name="attr_char_name" placeholder="John Exampleton"/>
                </label>
            </li>

            <li>
                <label>
                    Size
                    <br>
                    <select name="attr_char_size">
                        <option value="tiny">Tiny</option>
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                        <option value="huge">Huge</option>
                        <option value="enormous">Enormous</option>
                    </select>
                </label>
            </li>

            <li class="pconly">
                <label>
                    DNA
                    <br>
                    <input type="text" name="attr_char_dna" class="dna">
                </label>
            </li>

            <li class="npconly">
                <label>
                    Creature Type
                    <br>
                    <select name="attr_char_creaturetype" class="creature">
                        <option value="humanoid" selected>Humanoid</option>
                        <option value="mechanoid">Mechanoid</option>
                        <option value="nonhuman">Non-Human Person</option>
                        <option value="terrestrial">Terrestrial Beast</option>
                        <option value="alien">Alien Beast</option>
                    </select>
                </label>
            </li>

            <li class="pconly">
                <label>
                    Level
                    <br>
                    <input type="number" min="1" max="20" value="1" name="attr_char_level"/>
                </label>
            </li>

            <li class="pconly">
                <label>
                    Class
                    <br>
                    <input type="text" id="charclass" name="attr_char_class">
                </label>
            </li>

            <li class="npconly">
                <label>
                    Challenge
                    <br>
                    <select name="attr_char_challenge" id="challengerating">
                        <option value="0">0</option>
                        <option value="0.25">0.25</option>
                        <option value="0.5">0.5</option>
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                    </select>
                </label>
            </li>

            <li class="npconly">
                <label>
                    Personality
                    <br>
                    <select name="attr_char_personalitytype">
                        <option disabled style="font-weight: bold;">Peaceful</option> <!-- Workaround for optgroups, which appear to be broken in Roll20 -->
                            <option value="pcf_loner">Loner</option>
                            <option value="pcf_conformist">Conformist</option>
                            <option value="pcf_contributor">Contributor</option>
                        <option disabled style="font-weight: bold;">Neutral</option>
                            <option value="ntr_opportunist">Opportunist</option>
                            <option selected value="ntr_improvisor">Improvisor</option>
                            <option value="ntr_helper">Helper</option>
                        <option disabled style="font-weight: bold;">Aggressive</option>
                            <option value="agr_taker">Taker</option>
                            <option value="agr_survivor">Survivor</option>
                            <option value="agr_protector">Protector</option>
                    </select>
                </label>
            </li>

        </ul>

    </div>

    <!-- Stats -->

    <ul class="stats">

        <li>
            <div class="statheader">
                <label class="statname">
                    Strength
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_str" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_str"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Strength}} {{checkmod=@{str_mod}}} {{theroll=[[1d20+@{str_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>STR</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_str_mod" class="mod"/>
            </div>
        </li>

        <li>
            <div class="statheader">
                <label class="statname">
                    Agility
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_agi" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_agi"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Agility}} {{checkmod=@{agi_mod}}} {{theroll=[[1d20+@{agi_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>AGI</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_agi_mod" class="mod"/>
            </div>
        </li>

        <li>
            <div class="statheader">
                <label class="statname">
                    Endurance
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_end" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_end"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Endurance}} {{checkmod=@{end_mod}}} {{theroll=[[1d20+@{end_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>END</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_end_mod" class="mod"/>
            </div>
        </li>

        <li>
            <div class="statheader">
                <label class="statname">
                    Wits
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_wit" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_wit"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Wits}} {{checkmod=@{wit_mod}}} {{theroll=[[1d20+@{wit_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>WIT</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_wit_mod" class="mod"/>
            </div>

        <li>
            <div class="statheader">
                <label class="statname">
                    Knowledge
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_knw" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_knw"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Knowledge}} {{checkmod=@{knw_mod}}} {{theroll=[[1d20+@{knw_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>KNW</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_knw_mod" class="mod"/>
            </div>
        </li>

        <li>
            <div class="statheader">
                <label class="statname">
                    Presence
                    <br>
                    <input type="number" min="0" max="30" value="10" name="attr_prs" class="score"/>
                </label>
            </div>
            <div class="statbody">
                <button
                    type="roll"
                    name="roll_prs"
                    value="&{template:check} {{charname=@{char_name}}} {{checktype=Stat}} {{checkname=Presence}} {{checkmod=@{prs_mod}}} {{theroll=[[1d20+@{prs_mod}]]}}">
                    <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                    <span>PRS</span>
                </button>
                <br>
                <input readonly type="number" value="0" name="attr_prs_mod" class="mod"/>
            </div>
        </li>

    </ul>

    <!-- Vitals -->

    <div class="section vitals">

        <h1>Vitals</h1>

        <ul class="infolist">

            <li id="healthpoints">
                <label>
                    Health Points
                </label>
                <div>
                    <input type="number" min="0" max="1000" value="8" name="attr_hp"/>
                    of
                    <input type="number" min="1" max="1000" value="8" name="attr_hp_max"/>
                </div>
            </li>

            <li id="abilitypoints">
                <label>
                    Ability Points
                </label>
                <div>
                    <input type="number" min="0" max="20" value="1" name="attr_ap"/>
                    of
                    <input readonly type="number" min="1" value="1" name="attr_ap_max"/>
                </div>
            </li>

            <li id="stundamage">
                <label>
                    Stun Damage
                    <button
                        type="action"
                        name="act_clearstun">
                        <img src="https://www.d20helix.com/img/icon_refresh.png" alt="Clear 1 Round of Stun Damage" class="icon">
                    </button>
                </label>
                <div>
                    <input type="number" min="0" value="0" name="attr_stundamage"/>
                    of
                    <input readonly type="number" min="0" value="0" name="attr_stundamage_max"/>
                </div>
            </li>

            <li id="defense">
                <label>
                    Defense
                </label>
                <div>
                    <input readonly type="number" min="0" max="30" value="10" name="attr_defense" class="defense">
                </div>
            </li>

            <li class="pconly">
                <label>
                    Inspiration
                </label>
                <div>
                    <input type="number" min="0" max="3" value="0" name="attr_inspiration">
                </div>
            </li>

            <li id="determination" class="npconly">
                <label>
                    Determination
                </label>
                <div>
                    <input readonly type="number" min="1" max="20" value="1" name="attr_npc_determination" class="determination"/>
                </div>
            </li>

        </ul>

    </div>

    <!-- Tabbed Sections -->

    <div class="tabbed-view">

        <!-- Tab List -->

        <input type="radio" name="tabset" id="tab1" aria-controls="tab-panel1" checked>
        <label class="tab-heading" for="tab1">Core Info & Skills</label>

        <input type="radio" name="tabset" id="tab2" aria-controls="tab-panel2">
        <label class="tab-heading" for="tab2">Attacks & Abilities</label>

        <input type="radio" name="tabset" id="tab3" aria-controls="tab-panel3">
        <label class="tab-heading" for="tab3">Psi-Powers</label>

        <input type="radio" name="tabset" id="tab4" aria-controls="tab-panel4">
        <label class="tab-heading" for="tab4">Inventory</label>

        <input type="radio" name="tabset" id="tab5" aria-controls="tab-panel5">
        <label class="tab-heading" for="tab5">Character Notes</label>

        <!-- Tabbed Content Panels -->

        <div class="tabbed-view-content">

            <!-- Tab Panel 1: Core Info & Skills -->

            <section id="tab-panel1" class="tab-panel">

                <div class="multicolumn">

                    <!--
                        Left Column
                    -->

                    <div class="section bigcolumn">

                        <!-- Core Info -->

                        <div class="subsection core">

                            <h2>Core Info</h2>

                            <ul class="infolist">

                                <li class="hitdice pconly">
                                    <div>
                                        <button
                                            type="action"
                                            name="act_usehitdie">
                                            <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                            <span>Hit Dice</span>
                                        </button>
                                        <select name="attr_hitdice_type">
                                            <option value="d6">d6</option>
                                            <option value="d8" selected>d8</option>
                                            <option value="d10">d10</option>
                                            <option value="d12">d12</option>
                                        </select>
                                    </div>
                                    <div>
                                        <input type="number" min="0" max="20" value="1" name="attr_hitdice"/>
                                        of
                                        <input readonly type="number" min="1" max="20" value="1" name="attr_hitdice_max"/>
                                    </div>
                                </li>

                                <li class="hitdice npconly">
                                    <label>
                                        Hit Dice
                                    </label>
                                    <div class="oneline">
                                        <input type="number" min="1" max="40" value="1" name="attr_npc_hitdice"/>
                                        <input readonly type="text" name="attr_npc_hitdice_type" value="d8"/>
                                    </div>
                                </li>

                                <li class="basehp npconly">
                                    <label>
                                        Base HP
                                    </label>
                                    <div class="oneline calculation">
                                        <span>&times;</span>
                                        <input readonly type="number" value="4.5" name="attr_npc_hp_avg"/>
                                        <span>&plus;</span>
                                        <input readonly type="number" value="0" name="attr_npc_hp_endbonus"/>
                                        <span>&equals;</span>
                                    </div>
                                    <div class="oneline result">
                                        <input readonly type="number" value="4" name="attr_npc_hp_default"/>
                                    </div>
                                </li>

                                <li class="mortality pconly">
                                    <label>
                                        Mortality Checks
                                    </label>
                                    <table>
                                        <tr>
                                            <td>
                                                Success
                                            </td>
                                            <td>
                                                <div>
                                                    <input type="checkbox" name="attr_mortality_s1" unchecked>
                                                    <input type="checkbox" name="attr_mortality_s2" unchecked>
                                                    <input type="checkbox" name="attr_mortality_s3" unchecked>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Failure
                                            </td>
                                            <td>
                                                <div>
                                                    <input type="checkbox" name="attr_mortality_f1" unchecked>
                                                    <input type="checkbox" name="attr_mortality_f2" unchecked>
                                                    <input type="checkbox" name="attr_mortality_f3" unchecked>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </li>

                                <li>
                                    <label>
                                        Speed
                                    </label>
                                    <div>
                                        <input type="number" min="0" max="20" value="6" name="attr_speed">
                                        m
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Proficiency Bonus
                                    </label>
                                    <div>
                                        <input readonly type="number" min="1" max="10" value="1" name="attr_prof_bonus" class="profbonus"/>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Passive Perception
                                    </label>
                                    <div>
                                        <input readonly type="number" min="0" value="0" name="attr_passive_perception" class="passive"/>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Passive Insight
                                    </label>
                                    <div>
                                        <input readonly type="number" min="0" value="0" name="attr_passive_insight" class="passive"/>
                                    </div>
                                </li>

                            </ul>

                        </div>

                        <!-- Resistances & Vulnerabilaties -->

                        <div class="subsection resistances">

                            <h2>Resistances & Vulnerabilaties</h2>

                            <fieldset class="repeating_resistances">

                                <div class="repeatingrow">

                                    <select name="attr_resistance_type">
                                        <option value="vulnerability">Vulnerability</option>
                                        <option value="resistance" selected>Resistance</option>
                                        <option value="immunity">Immunity</option>
                                    </select>

                                    <select name="attr_resistance_damagetype">
                                        <option value="ballistic" selected>Ballistic</option>
                                        <option value="blunt force">Blunt Force</option>
                                        <option value="chemical">Chemical</option>
                                        <option value="cold">Cold</option>
                                        <option value="electrical">Electrical</option>
                                        <option value="fire">Fire</option>
                                        <option value="psi">Psi</option>
                                        <option value="slashing">Slashing</option>
                                        <option value="sonic">Sonic</option>
                                        <option value="stun">Stun</option>
                                        <option value="toxic">Toxic</option>
                                    </select>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Proficiencies -->

                        <div class="subsection proficiencies pconly">

                            <h2>Tool Proficiencies</h2>

                            <fieldset class="repeating_toolproficiencies">

                                <div class="repeatingrow">

                                    <input type="text" name="attr_toolproficiency_name" placeholder="Item Name"/>

                                    <select name="attr_toolproficiency_type">
                                        <option value="weapon">Weapon</option>
                                        <option value="armor">Armor</option>
                                        <option value="utility" selected>Utility</option>
                                    </select>

                                </div>

                            </fieldset>

                        </div>

                    </div>

                    <!--
                        Right Column
                    -->

                    <div class="section smallcolumn">

                        <!-- Defensive Skills -->

                        <div class="subsection skills">

                            <h2>Defensive Skills</h2>

                            <table>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_constitution_prof" unchecked></td>
                                    <td><button
                                        name="roll_constitution"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Constitution}} {{checkmod=@{constitution_mod}}} {{theroll=[[1d20+@{constitution_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Constitution</span>
                                    </button></td>
                                    <td class="smalltext">END</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_constitution_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_constitution_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_evasion_prof" unchecked></td>
                                    <td><button
                                        name="roll_evasion"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Evasion}} {{checkmod=@{evasion_mod}}} {{theroll=[[1d20+@{evasion_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Evasion</span>
                                    </button></td>
                                    <td class="smalltext">AGI</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_evasion_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_evasion_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_mentaldefense_prof" unchecked></td>
                                    <td><button
                                        name="roll_mentaldefense"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Mental Defense}} {{checkmod=@{mentaldefense_mod}}} {{theroll=[[1d20+@{mentaldefense_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Mental Defense</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_mentaldefense_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_mentaldefense_mod"/></td>
                                </tr>

                            </table>

                        </div>

                        <!-- Practical Skills -->

                        <div class="subsection skills">

                            <h2>Practical Skills</h2>

                            <table>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_athletics_prof" unchecked></td>
                                    <td><button
                                        name="roll_athletics"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Athletics}} {{checkmod=@{athletics_mod}}} {{theroll=[[1d20+@{athletics_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Athletics</span>
                                    </button></td>
                                    <td class="smalltext">STR</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_athletics_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_athletics_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_acrobatics_prof" unchecked></td>
                                    <td><button
                                        name="roll_acrobatics"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Acrobatics}} {{checkmod=@{acrobatics_mod}}} {{theroll=[[1d20+@{acrobatics_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Acrobatics</span>
                                    </button></td>
                                    <td class="smalltext">AGI</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_acrobatics_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_acrobatics_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_creaturehandling_prof" unchecked></td>
                                    <td><button
                                        name="roll_creaturehandling"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Creature Handling}} {{checkmod=@{creaturehandling_mod}}} {{theroll=[[1d20+@{creaturehandling_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Creature Handling</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_creaturehandling_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_creaturehandling_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_culture_prof" unchecked></td>
                                    <td><button
                                        name="roll_culture"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Culture}} {{checkmod=@{culture_mod}}} {{theroll=[[1d20+@{culture_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Culture</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_culture_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_culture_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_deception_prof" unchecked></td>
                                    <td><button
                                        name="roll_deception"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Deception}} {{checkmod=@{deception_mod}}} {{theroll=[[1d20+@{deception_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Deception</span>
                                    </button></td>
                                    <td class="smalltext">PRS</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_deception_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_deception_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_driving_prof" unchecked></td>
                                    <td><button
                                        name="roll_driving"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Driving}} {{checkmod=@{driving_mod}}} {{theroll=[[1d20+@{driving_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Driving</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_driving_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_driving_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_fasthands_prof" unchecked></td>
                                    <td><button
                                        name="roll_fasthands"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Fast Hands}} {{checkmod=@{fasthands_mod}}} {{theroll=[[1d20+@{fasthands_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Fast Hands</span>
                                    </button></td>
                                    <td class="smalltext">AGI</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_fasthands_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_fasthands_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_history_prof" unchecked></td>
                                    <td><button
                                        name="roll_history"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=History}} {{checkmod=@{history_mod}}} {{theroll=[[1d20+@{history_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>History</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_history_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_history_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_insight_prof" unchecked></td>
                                    <td><button
                                        name="roll_insight"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Insight}} {{checkmod=@{insight_mod}}} {{theroll=[[1d20+@{insight_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Insight</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_insight_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_insight_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_intimidation_prof" unchecked></td>
                                    <td><button
                                        name="roll_intimidation"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Intimidation}} {{checkmod=@{intimidation_mod}}} {{theroll=[[1d20+@{intimidation_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Intimidation</span>
                                    </button></td>
                                    <td class="smalltext">PRS</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_intimidation_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_intimidation_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_investigation_prof" unchecked></td>
                                    <td><button
                                        name="roll_investigation"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Investigation}} {{checkmod=@{investigation_mod}}} {{theroll=[[1d20+@{investigation_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Investigation</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_investigation_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_investigation_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_medicine_prof" unchecked></td>
                                    <td><button
                                        name="roll_medicine"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Medicine}} {{checkmod=@{medicine_mod}}} {{theroll=[[1d20+@{medicine_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Medicine</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_medicine_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_medicine_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_nature_prof" unchecked></td>
                                    <td><button
                                        name="roll_nature"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Nature}} {{checkmod=@{nature_mod}}} {{theroll=[[1d20+@{nature_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Nature</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_nature_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_nature_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_perception_prof" unchecked></td>
                                    <td><button
                                        name="roll_perception"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Perception}} {{checkmod=@{perception_mod}}} {{theroll=[[1d20+@{perception_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Perception</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_perception_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_perception_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_persuasion_prof" unchecked></td>
                                    <td><button
                                        name="roll_persuasion"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Persuasion}} {{checkmod=@{persuasion_mod}}} {{theroll=[[1d20+@{persuasion_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Persuasion</span>
                                    </button></td>
                                    <td class="smalltext">PRS</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_persuasion_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_persuasion_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_psionics_prof" unchecked></td>
                                    <td><button
                                        name="roll_psionics"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Psionics}} {{checkmod=@{psionics_mod}}} {{theroll=[[1d20+@{psionics_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Psionics</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_psionics_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_psionics_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_stealth_prof" unchecked></td>
                                    <td><button
                                        name="roll_stealth"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Stealth}} {{checkmod=@{stealth_mod}}} {{theroll=[[1d20+@{stealth_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Stealth</span>
                                    </button></td>
                                    <td class="smalltext">AGI</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_stealth_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_stealth_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_survival_prof" unchecked></td>
                                    <td><button
                                        name="roll_survival"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Survival}} {{checkmod=@{survival_mod}}} {{theroll=[[1d20+@{survival_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Survival</span>
                                    </button></td>
                                    <td class="smalltext">WIT</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_survival_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_survival_mod"/></td>
                                </tr>

                                <tr>
                                    <td class="first"><input type="checkbox" name="attr_technology_prof" unchecked></td>
                                    <td><button
                                        name="roll_technology"
                                        type="roll"
                                        value="&{template:check} {{charname=@{char_name}}} {{checktype=Skill}} {{checkname=Technology}} {{checkmod=@{technology_mod}}} {{theroll=[[1d20+@{technology_mod}]]}}">
                                        <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                        <span>Technology</span>
                                    </button></td>
                                    <td class="smalltext">KNW</td>
                                    <td>+</td>
                                    <td><input type="number" min="-10" max="10" value="0" name="attr_technology_extra"/></td>
                                    <td class="last"><input readonly type="number" value="0" name="attr_technology_mod"/></td>
                                </tr>

                            </table>

                        </div>

                    </div>

                </div>

            </section>

            <!-- Tab Panel 2: Attacks & Abilities -->

            <section id="tab-panel2" class="tab-panel">

                <div class="singlecolumn">

                    <div class="section">

                        <!-- Attacks -->

                        <div class="subsection attacks">

                            <h2>Attacks</h2>

                            <div class="attacksgrid gridheadings">

                                <label class="description">Attack</label>
                                <label class="Range">Range</label>
                                <label class="ammo">Ammo & Reloads</label>
                                <label class="attack">Attack</label>
                                <label class="damage">Damage</label>

                            </div>

                            <fieldset class="repeating_attacks">

                                <div class="repeatingrow attacksgrid">

                                    <!-- Attack Name -->

                                    <div class="oneline description">
                                        <input type="text" name="attr_attack_name" placeholder="Attack Name"/>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent leanright">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_attack_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <!-- Range -->

                                    <select name="attr_attack_type">
                                        <option value="melee" selected>Melee</option>
                                        <option value="2_3">2m / 3m</option>
                                        <option value="3_5">3m / 5m</option>
                                        <option value="4_10">4m / 10m</option>
                                        <option value="5_15">5m / 15m</option>
                                        <option value="6_20">6m / 20m</option>
                                        <option value="8_30">8m / 30m</option>
                                        <option value="10_40">10m / 40m</option>
                                        <option value="15_50">15m / 60m</option>
                                        <option value="20_80">20m / 80m</option>
                                        <option value="30_120">30m / 120m</option>
                                        <option value="40_160">40m / 160m</option>
                                    </select>

                                    <!-- Ammo & Reloads -->
                                    <div id="ammo-reloads" class="verticalgroup">
                                        <div class="oneline verticalstretch ammo">
                                            <div class="oneline quantity">
                                                <img src="https://www.d20helix.com/img/icon_ammo.png" alt="" class="icon">
                                                <input type="number" min="0" max="100" value="1" name="attr_attack_ammo"/>
                                                <span>of</span>
                                                <input type="number" min="1" max="100" value="1" name="attr_attack_ammo_max"/>
                                            </div>
                                        </div>
                                        <div class="oneline verticalstretch reloads">
                                            <div class="stretchyholder">
                                                <button
                                                    name="act_reload"
                                                    type="action">
                                                    <img src="https://www.d20helix.com/img/icon_reload.png" alt="Reload" class="icon">
                                                    <span>Reload</span>
                                                </button>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_infinity.png" alt="Infinite">
                                            <input type="checkbox" name="attr_attack_unlimited_reloads" unchecked>
                                            <input id="reloadcount" type="number" min="0" max="20" value="0" name="attr_attack_ammoreloads"/>
                                            <div id="reloadplaceholder" class="stretchyholder placeholder">
                                                <img src="https://www.d20helix.com/img/icon_notapplicable.png" alt="" class="icon">
                                            </div>
                                        </div>
                                    </div>
                                    <div id="ammoplaceholder" class="verticalgroup placeholder">
                                        <img src="https://www.d20helix.com/img/icon_notapplicable.png" alt="" class="icon">
                                    </div>

                                    <!-- Attack -->
                                    <div class="attack verticalgroup">
                                        <div class="stretchyholder"> <!-- To ensure width exactly matches the button below -->
                                            <div class="oneline calculation">
                                                <div class="oneline">
                                                    <span>+</span>
                                                    <input readonly type="number" value="0" name="attr_attack_mod"/>
                                                </div>
                                                <label class="hastooltip">
                                                    <img src="https://www.d20helix.com/img/icon_disclosure.png" alt="Expand" class="icon">
                                                    <input type="checkbox" class="tooltipcontrol" unchecked>
                                                    <div class="tooltipcontent">
                                                        <div class="oneline">
                                                            <label>
                                                                Proficient?
                                                                <input type="checkbox" name="attr_attack_prof" checked>
                                                            </label>
                                                        </div>
                                                        <div class="oneline">
                                                            <select name="attr_attack_stat">
                                                                <option value="none">None</option>
                                                                <option value="str">STR</option>
                                                                <option value="agi" selected>AGI</option>
                                                                <option value="end">END</option>
                                                                <option value="wit">WIT</option>
                                                                <option value="knw">KNW</option>
                                                                <option value="prs">PRS</option>
                                                            </select>
                                                            +
                                                            <input type="number" min="-20" max="20" value="0" name="attr_attack_extra"/>
                                                        </div>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_useattack"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                                <span>Attack</span>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Damage -->
                                    <div class="damage verticalgroup">
                                        <div class="stretchyholder"> <!-- To ensure width exactly matches the button below -->
                                            <div class="oneline calculation">
                                                <input readonly type="text" value="" name="attr_attack_damagefinalcalc" class="damagedice"/>
                                                <input readonly type="text" value="" name="attr_attack_damagefinaltype" class="damagetype"/>
                                                <label class="hastooltip">
                                                    <img src="https://www.d20helix.com/img/icon_disclosure.png" alt="Expand" class="icon">
                                                    <input type="checkbox" class="tooltipcontrol" unchecked>
                                                    <div class="tooltipcontent">
                                                        <div class="oneline">
                                                            <input type="number" min="1" max="20" value="1" name="attr_attack_damagedicecount"/>
                                                            &times;
                                                            <select name="attr_attack_damagedicetype">
                                                                <option value="d4">d4</option>
                                                                <option value="d6" selected>d6</option>
                                                                <option value="d8">d8</option>
                                                                <option value="d10">d10</option>
                                                                <option value="d12">d12</option>
                                                                <option value="d20">d20</option>
                                                            </select>
                                                        </div>
                                                        <div class="oneline">
                                                            +
                                                            <select name="attr_attack_damagestat">
                                                                <option value="none">None</option>
                                                                <option value="str">STR</option>
                                                                <option value="agi" selected>AGI</option>
                                                                <option value="end">END</option>
                                                                <option value="wit">WIT</option>
                                                                <option value="knw">KNW</option>
                                                                <option value="prs">PRS</option>
                                                            </select>
                                                            +
                                                            <input type="number" min="-20" max="20" value="0" name="attr_attack_damageextra"/>
                                                        </div>
                                                        <div class="oneline">
                                                            <select id="damagetype" name="attr_attack_damagetype">
                                                                <option value="ballistic" selected>Ballistic</option>
                                                                <option value="blunt force">Blunt Force</option>
                                                                <option value="chemical">Chemical</option>
                                                                <option value="cold">Cold</option>
                                                                <option value="electrical">Electrical</option>
                                                                <option value="fire">Fire</option>
                                                                <option value="psi">Psi</option>
                                                                <option value="slashing">Slashing</option>
                                                                <option value="sonic">Sonic</option>
                                                                <option value="stun">Stun</option>
                                                                <option value="toxic">Toxic</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="stretchyholder">
                                            <button
                                                name="roll_damage"
                                                type="roll"
                                                value="&{template:damage} {{charname=@{char_name}}} {{damagetype=@{attack_damagetype}}} {{calculation=@{attack_damagefinalcalc}}} {{theroll=[[@{attack_damagefinalcalc}]]}}">
                                                <img src="https://www.d20helix.com/img/icon_roll.png" alt="Make a Roll" class="icon">
                                                <span>Damage</span>
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Abilities -->

                        <div class="subsection abilities pconly">

                            <h2>Abilities</h2>

                            <div class="abilitiesgrid gridheadings">

                                <label class="description">Ability & Stat</label>
                                <label class="cost">AP Cost</label>
                                <label class="range">Target & Range</label>
                                <label class="duration">Charge / Duration / Concentration</label>
                                <label class="roll">Roll / Modifier / Use</label>

                            </div>

                            <fieldset class="repeating_abilities">

                                <div class="repeatingrow abilitiesgrid">

                                    <div class="oneline description">
                                        <input type="text" name="attr_ability_name" placeholder="Ability Name"/>
                                        <select name="attr_ability_stat">
                                            <option value="str">STR</option>
                                            <option value="agi" selected>AGI</option>
                                            <option value="end">END</option>
                                            <option value="wit">WIT</option>
                                            <option value="knw">KNW</option>
                                            <option value="prs">PRS</option>
                                        </select>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent leanright">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_ability_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline cost">
                                        <input type="number" min="0" max="20" value="1" name="attr_ability_apcost"/>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_attack_target">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_attack_range">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_ability_chargeup">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_ability_duration">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_ability_concentration" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_ability_rolltype">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <input readonly type="number" min="-20" max="20" value="0" name="attr_ability_mod"/>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_useability"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Techniques -->

                        <div class="subsection techniques">

                            <h2>Techniques</h2>

                            <div class="techniquesgrid gridheadings">

                                <label class="description">Technique / Bonus</label>
                                <label class="recharge">Recharge Rate</label>
                                <label class="quantity">Current Amount</label>
                                <label class="describe">Describe</label>

                            </div>

                            <fieldset class="repeating_techniques">

                                <div class="repeatingrow techniquesgrid">

                                    <div class="oneline description">
                                        <input type="text" name="attr_technique_name" placeholder="Technique / Bonus Name"/>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent leanright">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_technique_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <select id="techniquetype" name="attr_technique_type" class="longfield">
                                        <option value="shortrest" selected>Short Rest</option>
                                        <option value="longrest">Long Rest</option>
                                        <option value="turn">Turn</option>
                                        <option value="roll3">Roll 3-6</option>
                                        <option value="roll4">Roll 4-6</option>
                                        <option value="roll5">Roll 5-6</option>
                                        <option value="roll6">Roll 6</option>
                                        <option value="timed">Timed</option>
                                        <option value="escalating">Escalating Difficulty</option>
                                        <option value="unlimited">Unlimited</option>
                                    </select>

                                    <div class="oneline quantity">
                                        <input type="number" min="0" max="100" value="1" name="attr_technique_amount"/>
                                        <span>of</span>
                                        <input type="number" min="1" max="100" value="1" name="attr_technique_max"/>
                                    </div>
                                    <div id="quantityplaceholder" class="verticalgroup placeholder">
                                        <img src="https://www.d20helix.com/img/icon_notapplicable.png" alt="" class="icon">
                                    </div>

                                    <div class="oneline verticalstretch describe">
                                        <div class="stretchyholder">
                                            <button
                                                name="roll_technique_description"
                                                type="roll"
                                                value="&{template:description} {{charname=@{char_name}}} {{subjectname=@{technique_name}}} {{desc=@{technique_desc}}}">
                                                <img src="https://www.d20helix.com/img/icon_speech.png" alt="Describe in Chat" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Passive Bonuses -->

                        <div class="subsection passives">

                            <h2>Passive Bonuses</h2>

                            <div class="passivesgrid gridheadings">

                                <label class="description">Source</label>
                                <label class="recharge">Passive Bonus</label>
                                <label class="describe">Describe</label>

                            </div>

                            <fieldset class="repeating_passives">

                                <div class="repeatingrow passivesgrid">

                                    <select name="attr_passive_source" class="longfield">
                                        <option value="class" selected>Class Bonus</option>
                                        <option value="dna">DNA Bonus</option>
                                        <option value="feat">Feat</option>
                                        <option value="augmentation">Augmentation</option>
                                    </select>

                                    <div class="oneline description">
                                        <input type="text" name="attr_passive_name" placeholder="Passive Bonus Name"/>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_passive_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline verticalstretch describe">
                                        <div class="stretchyholder">
                                            <button
                                                name="roll_passive_description"
                                                type="roll"
                                                value="&{template:description} {{charname=@{char_name}}} {{subjectname=@{passive_name}}} {{subtype=@{passive_source} Bonus}} {{desc=@{passive_desc}}}">
                                                <img src="https://www.d20helix.com/img/icon_speech.png" alt="Describe in Chat" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                    </div>

                </div>

            </section>

            <!-- Tab Panel 3: Psi-Powers -->

            <section id="tab-panel3" class="tab-panel">

                <div class="singlecolumn">

                    <div class="section powers">

                        <ul class="powerstats infolist">
                            <li>
                                <label>
                                    Attack Bonus
                                    <input readonly type="number" value="0" name="attr_power_attackbonus"/>
                                    +
                                </label>
                                <input type="number" min="-10" max="10" value="0" name="attr_power_attackbonus_extra"/>
                            </li>
                            <li>
                                <label>
                                    Difficulty Class (DC)
                                    <input readonly type="number" value="0" name="attr_power_dc"/>
                                    +
                                </label>
                                <input type="number" min="-10" max="10" value="0" name="attr_power_dc_extra"/>
                            </li>
                        </ul>

                        <!-- Field Headings -->

                        <div class="subsection powerheadings">

                            <div class="powersgrid gridheadings">
                                <label class="description">Psi-Power & Discipline</label>
                                <label class="range">Target & Range</label>
                                <label class="duration">Charge / Duration / Concentration</label>
                                <label class="roll">Roll Type / Use</label>
                            </div>

                        </div>

                        <!-- Base Tier -->

                        <div class="subsection tier0">

                            <h2><span>Base Tier</span><span>AP Cost: None</span></h2>

                            <fieldset class="repeating_powers0">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline0" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name0" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc0" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target0">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range0">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup0">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration0">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration0" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype0">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower0"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 1 -->

                        <div class="subsection tier1">

                            <h2><span>Tier 1</span><span>AP Cost: 1</span></h2>

                            <fieldset class="repeating_powers1">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline1" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name1" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc1" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target1">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range1">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup1">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration1">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration1" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype1">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower1"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 2 -->

                        <div class="subsection tier2">

                            <h2><span>Tier 2</span><span>AP Cost: 3</span></h2>

                            <fieldset class="repeating_powers2">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline2" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name2" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc2" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target2">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range2">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup2">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration2">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration2" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype2">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower2"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 3 -->

                        <div class="subsection tier3">

                            <h2><span>Tier 3</span><span>AP Cost: 5</span></h2>

                            <fieldset class="repeating_powers3">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline3" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name3" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc3" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target3">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range3">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup3">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration3">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration3" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype3">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower3"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 4 -->

                        <div class="subsection tier4">

                            <h2><span>Tier 4</span><span>AP Cost: 7</span></h2>

                            <fieldset class="repeating_powers4">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline4" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>
                                        
                                        <input type="text" name="attr_power_name4" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc4" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target4">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range4">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup4">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration4">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration4" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype4">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower4"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 5 -->

                        <div class="subsection tier5">

                            <h2><span>Tier 5</span><span>AP Cost: 9</span></h2>

                            <fieldset class="repeating_powers5">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline5" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name5" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc5" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target5">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range5">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup5">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration5">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration5" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype5">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower5"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 6 -->

                        <div class="subsection tier6">

                            <h2><span>Tier 6</span><span>AP Cost: 11</span></h2>

                            <fieldset class="repeating_powers6">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline6" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name6" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc6" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target6">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range6">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup6">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration6">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration6" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype6">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower6"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 7 -->

                        <div class="subsection tier7">

                            <h2><span>Tier 7</span><span>AP Cost: 13</span></h2>

                            <fieldset class="repeating_powers7">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline7" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name7" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc7" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target7">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range7">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup7">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration7">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration7" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype7">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower7"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 8 -->

                        <div class="subsection tier8">

                            <h2><span>Tier 8</span><span>AP Cost: 15</span></h2>

                            <fieldset class="repeating_powers8">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline8" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name8" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc8" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target8">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range8">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup8">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration8">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration8" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype8">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower8"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                        <!-- Tier 9 -->

                        <div class="subsection tier9">

                            <h2><span>Tier 9</span><span>AP Cost: 17</span></h2>

                            <fieldset class="repeating_powers9">

                                <div class="repeatingrow powersgrid">

                                    <div class="oneline description">

                                        <label class="hasoptions">
                                            <input type="checkbox" class="optioncontrol" unchecked>
                                            <img src="https://www.d20helix.com/img/icon_expand.png" alt="" class="icon expander"/>
                                            <div class="optionscontent">
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="generic" checked>
                                                    <label for="generic">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_generic.png" alt="" class="icon selectable"/>
                                                        <span>Generic</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="cognition">
                                                    <label for="cognition">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_cognition.png" alt="" class="icon selectable"/>
                                                        <span>Cognition</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="corruption">
                                                    <label for="corruption">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_corruption.png" alt="" class="icon selectable"/>
                                                        <span>Corruption</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="elementalism">
                                                    <label for="elementalism">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_elementalism.png" alt="" class="icon selectable"/>
                                                        <span>Elementalism</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="kinesis">
                                                    <label for="kinesis">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_kinesis.png" alt="" class="icon selectable"/>
                                                        <span>Kinesis</span>
                                                    </label>
                                                </div>
                                                <div class="singleoption">
                                                    <input type="radio" name="attr_psidiscipline9" value="manipulation">
                                                    <label for="manipulation">
                                                        <img src="https://www.d20helix.com/img/icon_psidiscipline_manipulation.png" alt="" class="icon selectable"/>
                                                        <span>Manipulation</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <img src="https://www.d20helix.com/img/icon_psidiscipline_selection.png" alt="" class="icon optionplaceholder"/>
                                        </label>

                                        <input type="text" name="attr_power_name9" placeholder="Psi-Power Name"/>

                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_power_desc9" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline range">
                                        <select name="attr_power_target9">
                                            <option value="area">Area</option>
                                            <option value="best">Beast</option>
                                            <option value="creature">Creature</option>
                                            <option value="corpse">Corpse</option>
                                            <option value="object">Object</option>
                                            <option value="person">Person</option>
                                            <option value="self">Self</option>
                                        </select>
                                        <select name="attr_power_range9">
                                            <option value="na" selected>&ndash;</option>
                                            <option value="touch">Touch</option>
                                            <option value="1m">1m</option>
                                            <option value="2m">2m</option>
                                            <option value="3m">3m</option>
                                            <option value="4m">4m</option>
                                            <option value="5m">5m</option>
                                            <option value="6m">6m</option>
                                            <option value="8m">8m</option>
                                            <option value="10m">10m</option>
                                            <option value="15m">15m</option>
                                            <option value="20m">20m</option>
                                            <option value="30m">30m</option>
                                            <option value="40m">40m</option>
                                            <option value="50m">50m</option>
                                            <option value="100m">100m</option>
                                            <option value="1km">1km</option>
                                            <option value="5km">5km</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                    </div>

                                    <div class="oneline duration">
                                        <select name="attr_power_chargeup9">
                                            <option value="majoraction">Major Action</option>
                                            <option value="minoraction">Minor Action</option>
                                            <option value="reaction">Reaction</option>
                                            <option value="trigger">Trigger</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                        </select>
                                        <select name="attr_power_duration9">
                                            <option value="instant">Instant</option>
                                            <option value="1round">1 Round</option>
                                            <option value="5round">5 Rounds</option>
                                            <option value="1min">1 Minute</option>
                                            <option value="10min">10 Minutes</option>
                                            <option value="1hr">1 Hour</option>
                                            <option value="8hr">8 Hours</option>
                                            <option value="24hr">24 Hours</option>
                                            <option value="10day">10 Days</option>
                                            <option value="unlimited">∞</option>
                                        </select>
                                        <div class="backing">
                                            <input type="checkbox" name="attr_power_concentration9" unchecked>
                                        </div>
                                    </div>

                                    <div class="oneline roll">
                                        <select name="attr_power_rolltype9">
                                            <option value="attack" selected>Attack</option>
                                            <option value="difficulty">DC</option>
                                            <option value="none">None</option>
                                        </select>
                                        <div class="stretchyholder">
                                            <button
                                                name="act_usepower9"
                                                type="action">
                                                <img src="https://www.d20helix.com/img/icon_use.png" alt="More Info" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                    </div>

                </div>

            </section>

            <!-- Tab Panel 4: Inventory -->

            <section id="tab-panel4" class="tab-panel">

                <!-- Money -->

                <div class="singlecolumn">

                    <div class="section money">

                        <ul class="money infolist">
                            <li>
                                <label>
                                    <span>Personal Money</span>
                                    <input type="number" value="0" name="attr_money_amount"/>
                                    <select name="attr_money_type">
                                        <option value="credits" selected>Credits</option>
                                        <option value="dollars">Dollars</option>
                                        <option value="euros">Euros</option>
                                        <option value="gold">Gold</option>
                                        <option value="pound">Pounds</option>
                                        <option value="salvage">Salvage</option>
                                        <option value="yen">Yen</option>
                                    </select>
                                </label>
                            </li>
                        </ul>

                    </div>

                </div>

                <!-- Two Columns -->

                <div class="multicolumn">

                    <!--
                        Left Column
                    -->

                    <div class="section">

                        <!-- Armor -->

                        <div class="subsection armor">

                            <h2>Armor</h2>

                            <ul class="armor">

                                <li>
                                    <label>
                                        Main Armor
                                    </label>
                                    <div>
                                        <div class="armorgrid">
                                            <label>
                                                Type
                                                <select name="attr_armortype">
                                                    <option value="none" selected>None</option>
                                                    <option value="lgt">Light</option>
                                                    <option value="med">Medium</option>
                                                    <option value="hvy">Heavy</option>
                                                </select>
                                            </label>
                                            <label>
                                                Name
                                                <input type="text" name="attr_armor"/>
                                            </label>
                                        </div>
                                        <div class="armorgrid">
                                            <label>
                                                Base Defense
                                                <input type="number" min="10" max="20" value="10" name="attr_armorbase"/>
                                            </label>
                                            <label>
                                                Max AGI Bonus
                                                <select name="attr_armorcap" id="armorcap">
                                                    <option value="unlimited" selected>&infin;</option>
                                                    <option value="2">2</option>
                                                    <option value="0">0</option>
                                                </select>
                                            </label>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Additional Defense
                                    </label>
                                    <div>
                                        <div class="armorgrid">
                                            <label>
                                                Extra Armor
                                                <input type="number" min="0" max="20" value="0" name="attr_armorextra"/>
                                            </label>
                                            <label>
                                                Shield
                                                <select name="attr_shield">
                                                    <option value="none" selected>None</option>
                                                    <option value="shield_p0">Standard Shield</option>
                                                    <option value="shield_p1">Shield +1</option>
                                                    <option value="shield_p2">Shield +2</option>
                                                </select>
                                            </label>
                                        </div>
                                        <div class="armorgrid">
                                            <label>
                                                Include END Bonus?
                                                <input type="checkbox" unchecked name="attr_armorendbonus"/>
                                            </label>
                                            <div></div> <!-- A blank to occupy the final spot on the grid -->
                                        </div>
                                    </div>
                                </li>

                            </ul>

                        </div>

                        <!-- Mods -->

                        <div class="subsection mods">

                            <h2>Mods</h2>

                            <div class="modsgrid gridheadings">

                                <label class="description">Mod</label>
                                <label class="type">Mod Type</label>
                                <label class="type">Attached To</label>
                                <label class="describe">Describe</label>

                            </div>

                            <fieldset class="repeating_mods">

                                <div class="repeatingrow modsgrid">

                                    <div class="oneline description">
                                        <input type="text" name="attr_mod_name" placeholder="Mod Name"/>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent leanright">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_mod_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <select name="attr_mod_type">
                                        <option value="weapon" selected>Weapon</option>
                                        <option value="armor">Armor</option>
                                    </select>

                                    <input type="text" name="attr_mod_target" placeholder=""/>

                                    <div class="oneline describe">
                                        <div class="stretchyholder">
                                            <button
                                                name="roll_mod_description"
                                                type="roll"
                                                value="&{template:description} {{charname=@{char_name}}} {{subjectname=@{mod_name}}} {{subtype=@{mod_type} Mod}} {{desc=@{mod_desc}}} {{amount=}} {{amountmax=}}">
                                                <img src="https://www.d20helix.com/img/icon_speech.png" alt="Describe in Chat" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                    </div>

                    <!--
                        Right Column
                    -->

                    <div class="section">

                        <!-- Weapons -->

                        <div class="subsection weapons">

                            <h2>Weapons</h2>

                            <ul class="weapons">

                                <li>
                                    <label>
                                        Melee Weapons
                                    </label>
                                    <div>
                                        <div class="oneline description">
                                            <input type="text" name="attr_weapon_melee1_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_melee1_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                        <div class="oneline description">
                                            <input type="text" name="attr_weapon_melee2_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_melee2_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Handguns
                                    </label>
                                    <div>
                                        <div>
                                            <input type="text" name="attr_weapon_handgun1_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_handgun1_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                        <div>
                                            <input type="text" name="attr_weapon_handgun2_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_handgun2_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Long Guns
                                    </label>
                                    <div>
                                        <div>
                                            <input type="text" name="attr_weapon_long1_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_long1_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                        <div>
                                            <input type="text" name="attr_weapon_long2_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_long2_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <label>
                                        Heavy/Special Weapons
                                    </label>
                                    <div>
                                        <div>
                                            <input type="text" name="attr_weapon_heavy1_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_heavy1_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                        <div>
                                            <input type="text" name="attr_weapon_heavy2_name"/>
                                            <label class="hastooltip">
                                                <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                                <input type="checkbox" class="tooltipcontrol" unchecked>
                                                <div class="tooltipcontent">
                                                    <div class="stretchyholder">
                                                        <textarea name="attr_weapon_heavy2_desc" placeholder="Enter a description"></textarea>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </li>

                            </ul>

                        </div>

                        <!-- Other Items -->

                        <div class="subsection inventory">

                            <h2>Other Items</h2>

                            <div class="inventorygrid gridheadings">

                                <label class="description">Item</label>
                                <label class="quantity">Current Amount</label>
                                <label class="describe">Describe</label>

                            </div>

                            <fieldset class="repeating_inventory">

                                <div class="repeatingrow inventorygrid">

                                    <div class="oneline description">
                                        <input type="text" name="attr_inventory_name" placeholder="Item Name"/>
                                        <label class="hastooltip">
                                            <img src="https://www.d20helix.com/img/icon_info.png" alt="More Info" class="icon">
                                            <input type="checkbox" class="tooltipcontrol" unchecked>
                                            <div class="tooltipcontent">
                                                <div class="stretchyholder">
                                                    <textarea name="attr_inventory_desc" placeholder="Enter a description"></textarea>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="oneline quantity">
                                        <input type="number" min="0" max="100" value="1" name="attr_inventory_amount"/>
                                        <span>of</span>
                                        <input type="number" min="1" max="100" value="1" name="attr_inventory_amount_max"/>
                                    </div>

                                    <div class="oneline describe">
                                        <div class="stretchyholder">
                                            <button
                                                name="roll_inventory_description"
                                                type="roll"
                                                value="&{template:description} {{charname=@{char_name}}} {{subjectname=@{inventory_name}}} {{desc=@{inventory_desc}}} {{amount=@{inventory_amount}}} {{amountmax=@{inventory_amount|max}}}">
                                                <img src="https://www.d20helix.com/img/icon_speech.png" alt="Describe in Chat" class="icon">
                                            </button>
                                        </div>
                                    </div>

                                </div>

                            </fieldset>

                        </div>

                    </div>

                </div>

            </section>

            <!-- Tab Panel 5: Character Notes -->

            <section id="tab-panel5" class="tab-panel">

                <div class="singlecolumn">

                    <div class="section">

                        <!-- Backstory -->

                        <div class="subsection backstory">

                            <h2>Backstory</h2>

                            <div class="stretchyholder">
                                <textarea name="attr_char_backstory" placeholder="Here you can enter your character's backstory..."></textarea>
                            </div>

                        </div>

                        <!-- Character Developments -->

                        <div class="subsection developments">

                            <h2>Character Developments</h2>

                            <div class="stretchyholder">
                                <textarea name="attr_char_developments" placeholder="Here you can enter any significant developments for your character since you started playing..."></textarea>
                            </div>

                        </div>

                        <!-- Personal Objectives -->

                        <div class="subsection objectives">

                            <h2>Personal Objectives</h2>

                            <div class="stretchyholder">
                                <textarea name="attr_char_objectives" placeholder="Here you can enter any personal objectives your character may currently have..."></textarea>
                            </div>

                        </div>

                    </div>

                </div>

            </section>

        </div>

    </div>

    <!-- Footer -->

    <div class="footer">

        <ul>
            <li>d20 Helix System</li>
            <li>Character Sheet v1.1.0</li>
        </ul>
        <div class="attributions">
            <span>This work includes material taken from the System Reference Document 5.1 (“SRD 5.1”) by Wizards of the Coast LLC, available at https://dnd.wizards.com/resources/systems-reference-document.</span>
            <span>The SRD 5.1 is licensed under the Creative Commons Attribution 4.0 International License available at https://creativecommons.org/licenses/by/4.0/legalcode. No other portion of this work may be reproduced in any form without permission.</span>
        </div>

    </div>

</div>

<!-- Roll Templates -->

<rolltemplate class="sheet-rolltemplate-check">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">{{checktype}} Check</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-checkname">{{checkname}}</div>
            <div class="sheet-checkmod">+ {{checkmod}}</div>
            <div class="sheet-result">{{theroll}}</div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-attack">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">Attack</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-attackname">{{attackname}}</div>
            {{#attackdesc}}<div class="sheet-desc">{{attackdesc}}</div>{{/attackdesc}} <!-- Only displays this div if this optional field was provided -->
            <div class="sheet-attackmod">+ {{attackmod}}</div>
            {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}} <!-- Only displays this div if this optional field was provided -->
            <div class="sheet-result">{{theroll}}</div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-damage">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">Damage</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-calculation">{{calculation}}</div>
            <div class="sheet-result">{{theroll}}</div>
            <div class="sheet-damagetype">{{damagetype}}</div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-ability">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">{{abilitytype}}</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-abilityname">{{abilityname}}</div>
            {{#abilitysubtype}}<div class="sheet-abilitystat">{{abilitysubtype}}</div>{{/abilitysubtype}} <!-- Only displays this div if this optional field was provided -->
            {{#abilitydesc}}<div class="sheet-desc">{{abilitydesc}}</div>{{/abilitydesc}} <!-- Only displays this div if this optional field was provided -->
            {{#abilitymod}}<div class="sheet-abilitymod">+ {{abilitymod}}</div>{{/abilitymod}} <!-- Only displays this div if this optional field was provided -->
            {{#theroll}}<div class="sheet-result">{{theroll}}</div>{{/theroll}} <!-- Only displays this div if this optional field was provided -->
            {{#abilitydc}}<div class="sheet-result"><span>DC: {{abilitydc}}</span></div>{{/abilitydc}} <!-- Only displays this div if this optional field was provided -->
            {{#abilityisconcentration}}<div class="sheet-concentration"><span>Concentration</span></div>{{/abilityisconcentration}} <!-- Only displays this div if this optional field was provided -->
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-hitdie">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">Hit Die</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-dietype">{{dietype}}</div>
            <div class="sheet-endmod">+ {{endmod}}</div>
            <div class="sheet-result">{{theroll}}</div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-description">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">Description</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-subjectname">{{subjectname}}</div>
            {{#subtype}}<div class="sheet-subtype">{{subtype}}</div>{{/subtype}} <!-- Only displays this div if this optional field was provided -->
            <div class="sheet-desc">{{desc}}</div>
            {{#amount}}<div class="sheet-amount"> <!-- Only displays this div if this optional field was provided -->
                <span>Amount: {{amount}}</span>
                {{#amountmax}}<span> of {{amountmax}}</span>{{/amountmax}} <!-- Only displays this div if this optional field was provided -->
            </div>{{/amount}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-warning">
    {{#charname}}<div class="sheet-prefix"> <!-- Only displays this div if this optional field was provided -->
        <span>{{charname}}</span>
    </div>{{/charname}}
    <div class="sheet-container">
        <div class="sheet-header">
            <div class="sheet-title">Warning</div>
        </div>
        <div class="sheet-content">
            <div class="sheet-subjectname">{{subjectname}}</div>
            <div class="sheet-desc">{{desc}}</div>
        </div>
    </div>
</rolltemplate>

<!-- Worker Scripts -->
<!-- In order for these to work, they must all be within one script tag with the exact type of "text/worker" -->

<script type="text/worker">

    // Action Buttons

    // Using Hit Dice
    on("clicked:usehitdie", (eventInfo) => {
        getAttrs( [
            "hitdice",
            "hitdice_type",
            "end_mod",
            "char_name"
        ], (values) => {
            if (values.hitdice > 0) {
                setAttrs({
                    hitdice: Math.max(0, (values.hitdice - 1)) // Reduce the hit dice count by 1
                });
                startRoll("&{template:hitdie} {{charname=" + values.char_name + "}} {{dietype=" + values.hitdice_type + "}} {{endmod=" + values.end_mod + "}} {{theroll=[[1" + values.hitdice_type + "+" + values.end_mod + "]]}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            } else {
                // Not enough Hit Dice to make the roll
                startRoll("&{template:warning} {{charname=" + values.char_name + "}} {{subjectname=Hit Dice}} {{desc=Unable roll a hit die: None left!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });

    // Clearing Stun Damage
    on("clicked:clearstun", (eventInfo) => {
        getAttrs( [
            "stundamage",
            "hp_max"
        ], (values) => {
            setAttrs({
                stundamage: Math.max(0, (values.stundamage - Math.ceil(values.hp_max/2))) // Reduce the stun damage by up to half the character's total HP
            });
        });
    });

    // Attacking
    on("clicked:repeating_attacks:useattack", (eventInfo) => {
        getAttrs( [
            "repeating_attacks_attack_name",
            "repeating_attacks_attack_desc",
            "repeating_attacks_attack_type",
            "repeating_attacks_attack_ammo",
            "repeating_attacks_attack_mod",
            "char_name"
        ], (values) => {
            if ((values.repeating_attacks_attack_type == "melee") || (values.repeating_attacks_attack_ammo > 0)) {
                setAttrs({
                    repeating_attacks_attack_ammo: Math.max(0, (values.repeating_attacks_attack_ammo - 1)) // Reduce the ammo amount by 1
                });
                startRoll("&{template:attack} {{charname=" + values.char_name + "}} {{attackname=" + values.repeating_attacks_attack_name + "}} {{attackdesc=" + values.repeating_attacks_attack_desc + "}} {{attackmod=" + values.repeating_attacks_attack_mod + "}} {{theroll=[[1d20+" + values.repeating_attacks_attack_mod + "]]}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            } else {
                // Not enough ammo to make the attack
                startRoll("&{template:warning} {{charname=" + values.char_name + "}} {{subjectname=" + values.repeating_attacks_attack_name + "}} {{desc=Unable to attack: No ammo loaded!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });

    // Reloading
    on("clicked:repeating_attacks:reload", (eventInfo) => {
        getAttrs( [
            "repeating_attacks_attack_name",
            "repeating_attacks_attack_type",
            "repeating_attacks_attack_ammo",
            "repeating_attacks_attack_ammo_max",
            "repeating_attacks_attack_unlimited_reloads",
            "repeating_attacks_attack_ammoreloads",
            "char_name"
        ], (values) => {
            if ((values.repeating_attacks_attack_type == "melee") || (values.repeating_attacks_attack_ammo == values.repeating_attacks_attack_ammo_max)) {
                return; // Melee weapons and weapons with full ammo don't need reloads
            } else {
                if ((values.repeating_attacks_attack_unlimited_reloads == 0) && (values.repeating_attacks_attack_ammoreloads == 0)) {
                    // If reloads are tracked and there aren't any left, the reload can't happen
                    startRoll("&{template:warning} {{charname=" + values.char_name + "}} {{subjectname=" + values.repeating_attacks_attack_name + "}} {{desc=Unable to reload: No reloads remaining!}}", (results) => {
                        finishRoll(results.rollId); // Required before it gets posted to chat
                    });
                } else {
                    setAttrs({
                        repeating_attacks_attack_ammo: values.repeating_attacks_attack_ammo_max, // Refill the loaded amount
                        repeating_attacks_attack_ammoreloads: Math.max(0, (values.repeating_attacks_attack_ammoreloads - 1)) // Reduce the reloads by 1
                    });
                }
            }
        });
    });

    // Performing abilities
    on("clicked:repeating_abilities:useability", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_abilities_ability_name",
            "repeating_abilities_ability_desc",
            "repeating_abilities_ability_apcost",
            "repeating_abilities_ability_stat",
            "repeating_abilities_ability_rolltype",
            "repeating_abilities_ability_mod",
            "char_name"
        ], (values) => {
            if (values.ap >= values.repeating_abilities_ability_apcost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - values.repeating_abilities_ability_apcost)) // Reduce the AP amount by the required amount
                });

                switch (values.repeating_abilities_ability_rolltype) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}} {{abilitytype=Ability}} {{abilityname=" + values.repeating_abilities_ability_name + "}} {{abilitysubtype=" + values.repeating_abilities_ability_stat + "}} {{abilitymod=" + values.repeating_abilities_ability_mod + "}} {{abilitydesc=" + values.repeating_abilities_ability_desc + "}} {{theroll=[[1d20+" + values.repeating_abilities_ability_mod + "]]}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}} {{abilitytype=Ability}} {{abilityname=" + values.repeating_abilities_ability_name + "}} {{abilitysubtype=" + values.repeating_abilities_ability_stat + "}} {{abilitydc=" + values.repeating_abilities_ability_mod + "}} {{abilitydesc=" + values.repeating_abilities_ability_desc + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        //Assume 'none' if not a recognised value
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}} {{abilitytype=Ability}} {{abilityname=" + values.repeating_abilities_ability_name + "}} {{abilitysubtype=" + values.repeating_abilities_ability_stat + "}} {{abilitydesc=" + values.repeating_abilities_ability_desc + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                }
            } else {
                // Not enough AP to use the ability
                startRoll("&{template:warning} {{charname=" + values.char_name + "}} {{subjectname=" + values.repeating_abilities_ability_name + "}} {{desc=Unable to use Ability: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });

    // Performing psi-powers
    // Includes one function for each psi-power tier, because they are implmented as different repeating sections
    on("clicked:repeating_powers0:usepower0", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers0_power_name0",
            "repeating_powers0_power_desc0",
            "repeating_powers0_psidiscipline0",
            "repeating_powers0_power_rolltype0",
            "repeating_powers0_power_concentration0",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            switch (values.repeating_powers0_power_rolltype0) {
                case "attack":
                    // Attack
                    startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers0_power_name0 + "}} {{abilitysubtype=" + values.repeating_powers0_psidiscipline0 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers0_power_desc0 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers0_power_concentration0 == 0) ? "" : "Yes") + "}}", (results) => {
                        finishRoll(results.rollId); // Required before it gets posted to chat
                    });
                    break;
                case "difficulty":
                    // Difficulty Check
                    startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers0_power_name0 + "}} {{abilitysubtype=" + values.repeating_powers0_psidiscipline0 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers0_power_desc0 + "}} {{abilityisconcentration=" + ((values.repeating_powers0_power_concentration0 == 0) ? "" : "Yes") + "}}", (results) => {
                        finishRoll(results.rollId); // Required before it gets posted to chat
                    });
                    break;
                default:
                    // Description only
                    startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers0_power_name0 + "}} {{abilitysubtype=" + values.repeating_powers0_psidiscipline0 + "}} {{abilitydesc=" + values.repeating_powers0_power_desc0 + "}} {{abilityisconcentration=" + ((values.repeating_powers0_power_concentration0 == 0) ? "" : "Yes") + "}}", (results) => {
                        finishRoll(results.rollId); // Required before it gets posted to chat
                    });
                    break;
            }
        });
    });
    on("clicked:repeating_powers1:usepower1", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers1_power_name1",
            "repeating_powers1_power_desc1",
            "repeating_powers1_psidiscipline1",
            "repeating_powers1_power_rolltype1",
            "repeating_powers1_power_concentration1",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 1; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers1_power_rolltype1) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers1_power_name1 + "}} {{abilitysubtype=" + values.repeating_powers1_psidiscipline1 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers1_power_desc1 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers1_power_concentration1 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers1_power_name1 + "}} {{abilitysubtype=" + values.repeating_powers1_psidiscipline1 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers1_power_desc1 + "}} {{abilityisconcentration=" + ((values.repeating_powers1_power_concentration1 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers1_power_name1 + "}} {{abilitysubtype=" + values.repeating_powers1_psidiscipline1 + "}} {{abilitydesc=" + values.repeating_powers1_power_desc1 + "}} {{abilityisconcentration=" + ((values.repeating_powers1_power_concentration1 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers1_power_name1 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers2:usepower2", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers2_power_name2",
            "repeating_powers2_power_desc2",
            "repeating_powers2_psidiscipline2",
            "repeating_powers2_power_rolltype2",
            "repeating_powers2_power_concentration2",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 3; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers2_power_rolltype2) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers2_power_name2 + "}} {{abilitysubtype=" + values.repeating_powers2_psidiscipline2 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers2_power_desc2 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers2_power_concentration2 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers2_power_name2 + "}} {{abilitysubtype=" + values.repeating_powers2_psidiscipline2 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers2_power_desc2 + "}} {{abilityisconcentration=" + ((values.repeating_powers2_power_concentration2 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers2_power_name2 + "}} {{abilitysubtype=" + values.repeating_powers2_psidiscipline2 + "}} {{abilitydesc=" + values.repeating_powers2_power_desc2 + "}} {{abilityisconcentration=" + ((values.repeating_powers2_power_concentration2 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers2_power_name2 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers3:usepower3", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers3_power_name3",
            "repeating_powers3_power_desc3",
            "repeating_powers3_psidiscipline3",
            "repeating_powers3_power_rolltype3",
            "repeating_powers3_power_concentration3",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 5; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers3_power_rolltype3) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers3_power_name3 + "}} {{abilitysubtype=" + values.repeating_powers3_psidiscipline3 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers3_power_desc3 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers3_power_concentration3 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers3_power_name3 + "}} {{abilitysubtype=" + values.repeating_powers3_psidiscipline3 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers3_power_desc3 + "}} {{abilityisconcentration=" + ((values.repeating_powers3_power_concentration3 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers3_power_name3 + "}} {{abilitysubtype=" + values.repeating_powers3_psidiscipline3 + "}} {{abilitydesc=" + values.repeating_powers3_power_desc3 + "}} {{abilityisconcentration=" + ((values.repeating_powers3_power_concentration3 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers3_power_name3 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers4:usepower4", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers4_power_name4",
            "repeating_powers4_power_desc4",
            "repeating_powers4_psidiscipline4",
            "repeating_powers4_power_rolltype4",
            "repeating_powers4_power_concentration4",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 7; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers4_power_rolltype4) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers4_power_name4 + "}} {{abilitysubtype=" + values.repeating_powers4_psidiscipline4 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers4_power_desc4 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers4_power_concentration4 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers4_power_name4 + "}} {{abilitysubtype=" + values.repeating_powers4_psidiscipline4 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers4_power_desc4 + "}} {{abilityisconcentration=" + ((values.repeating_powers4_power_concentration4 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers4_power_name4 + "}} {{abilitysubtype=" + values.repeating_powers4_psidiscipline4 + "}} {{abilitydesc=" + values.repeating_powers4_power_desc4 + "}} {{abilityisconcentration=" + ((values.repeating_powers4_power_concentration4 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers4_power_name4 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers5:usepower5", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers5_power_name5",
            "repeating_powers5_power_desc5",
            "repeating_powers5_psidiscipline5",
            "repeating_powers5_power_rolltype5",
            "repeating_powers5_power_concentration5",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 9; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers5_power_rolltype5) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers5_power_name5 + "}} {{abilitysubtype=" + values.repeating_powers5_psidiscipline5 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers5_power_desc5 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers5_power_concentration5 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers5_power_name5 + "}} {{abilitysubtype=" + values.repeating_powers5_psidiscipline5 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers5_power_desc5 + "}} {{abilityisconcentration=" + ((values.repeating_powers5_power_concentration5 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers5_power_name5 + "}} {{abilitysubtype=" + values.repeating_powers5_psidiscipline5 + "}} {{abilitydesc=" + values.repeating_powers5_power_desc5 + "}} {{abilityisconcentration=" + ((values.repeating_powers5_power_concentration5 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers5_power_name5 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers6:usepower6", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers6_power_name6",
            "repeating_powers6_power_desc6",
            "repeating_powers6_psidiscipline6",
            "repeating_powers6_power_rolltype6",
            "repeating_powers6_power_concentration6",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 11; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers6_power_rolltype6) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers6_power_name6 + "}} {{abilitysubtype=" + values.repeating_powers6_psidiscipline6 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers6_power_desc6 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers6_power_concentration6 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers6_power_name6 + "}} {{abilitysubtype=" + values.repeating_powers6_psidiscipline6 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers6_power_desc6 + "}} {{abilityisconcentration=" + ((values.repeating_powers6_power_concentration6 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers6_power_name6 + "}} {{abilitysubtype=" + values.repeating_powers6_psidiscipline6 + "}} {{abilitydesc=" + values.repeating_powers6_power_desc6 + "}} {{abilityisconcentration=" + ((values.repeating_powers6_power_concentration6 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers6_power_name6 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers7:usepower7", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers7_power_name7",
            "repeating_powers7_power_desc7",
            "repeating_powers7_psidiscipline7",
            "repeating_powers7_power_rolltype7",
            "repeating_powers7_power_concentration7",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 13; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers7_power_rolltype7) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers7_power_name7 + "}} {{abilitysubtype=" + values.repeating_powers7_psidiscipline7 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers7_power_desc7 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers7_power_concentration7 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers7_power_name7 + "}} {{abilitysubtype=" + values.repeating_powers7_psidiscipline7 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers7_power_desc7 + "}} {{abilityisconcentration=" + ((values.repeating_powers7_power_concentration7 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers7_power_name7 + "}} {{abilitysubtype=" + values.repeating_powers7_psidiscipline7 + "}} {{abilitydesc=" + values.repeating_powers7_power_desc7 + "}} {{abilityisconcentration=" + ((values.repeating_powers7_power_concentration7 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers7_power_name7 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers8:usepower8", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers8_power_name8",
            "repeating_powers8_power_desc8",
            "repeating_powers8_power_psidiscipline8",
            "repeating_powers8_power_rolltype8",
            "repeating_powers8_power_concentration8",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 15; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers8_power_rolltype8) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers8_power_name8 + "}} {{abilitysubtype=" + values.repeating_powers8_psidiscipline8 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers8_power_desc8 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers8_power_concentration8 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers8_power_name8 + "}} {{abilitysubtype=" + values.repeating_powers8_psidiscipline8 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers8_power_desc8 + "}} {{abilityisconcentration=" + ((values.repeating_powers8_power_concentration8 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers8_power_name8 + "}} {{abilitysubtype=" + values.repeating_powers8_psidiscipline8 + "}} {{abilitydesc=" + values.repeating_powers8_power_desc8 + "}} {{abilityisconcentration=" + ((values.repeating_powers8_power_concentration8 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers8_power_name8 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });
    on("clicked:repeating_powers9:usepower9", (eventInfo) => {
        getAttrs( [
            "ap",
            "repeating_powers9_power_name9",
            "repeating_powers9_power_desc9",
            "repeating_powers9_psidiscipline9",
            "repeating_powers9_power_rolltype9",
            "repeating_powers9_power_concentration9",
            "power_attackbonus",
            "power_attackbonus_extra",
            "power_dc",
            "power_dc_extra",
            "char_name"
        ], (values) => {
            const fullAttackBonus = (parseInt(values.power_attackbonus) || 0)  + (parseInt(values.power_attackbonus_extra) || 0); // Add in any manual extras to the attack bonus
            const fullDC = (parseInt(values.power_dc) || 0)  + (parseInt(values.power_dc_extra) || 0); // Add in any manual extras to the save DC
            const apCost = 17; // The appropriate AP cost for this tier
            if (values.ap >= apCost) {
                setAttrs({
                    ap: Math.max(0, (values.ap - apCost)) // Reduce the AP amount by the required amount
                });
                switch (values.repeating_powers9_power_rolltype9) {
                    case "attack":
                        // Attack
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers9_power_name9 + "}} {{abilitysubtype=" + values.repeating_powers9_psidiscipline9 + "}} {{abilitymod=" + fullAttackBonus + "}} {{abilitydesc=" + values.repeating_powers9_power_desc9 + "}} {{theroll=[[1d20+" + fullAttackBonus + "]]}} {{abilityisconcentration=" + ((values.repeating_powers9_power_concentration9 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    case "difficulty":
                        // Difficulty Check
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers9_power_name9 + "}} {{abilitysubtype=" + values.repeating_powers9_psidiscipline9 + "}} {{abilitydc=" + fullDC + "}} {{abilitydesc=" + values.repeating_powers9_power_desc9 + "}} {{abilityisconcentration=" + ((values.repeating_powers9_power_concentration9 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                    default:
                        // Description only
                        startRoll("&{template:ability} {{charname=" + values.char_name + "}}  {{abilitytype=Psi-Power}} {{abilityname=" + values.repeating_powers9_power_name9 + "}} {{abilitysubtype=" + values.repeating_powers9_psidiscipline9 + "}} {{abilitydesc=" + values.repeating_powers9_power_desc9 + "}} {{abilityisconcentration=" + ((values.repeating_powers9_power_concentration9 == 0) ? "" : "Yes") + "}}", (results) => {
                            finishRoll(results.rollId); // Required before it gets posted to chat
                        });
                        break;
                }
            } else {
                // Not enough AP to use the power
                startRoll("&{template:warning} {{charname=" + values.char_name + "}}  {{subjectname=" + values.repeating_powers9_power_name9 + "}} {{desc=Unable to use Psi-Power: Not enough AP remaining!}}", (results) => {
                    finishRoll(results.rollId); // Required before it gets posted to chat
                });
            }
        });
    });

    // Helper functions, to determining appropriate values based on input

    // Determine the name of the hit dice for each specific NPC size category
    function hitDiceForSize(sizeName) {
        switch(sizeName) {
            case "tiny":
                return "d4"
            case "small":
                return "d6"
            case "large":
                return "d10"
            case "huge":
                return "d12"
            case "enormous":
                return "d20"
            default: return "d8" // Assume a d8 for all others, as it's the most common
        }
    };

    // Determine the average roll for each hide dice size
    function avgRollForHitDice(diceType) {
        switch(diceType) {
            case "d4":
                return 2.5
            case "d6":
                return 3.5
            case "d10":
                return 5.5
            case "d12":
                return 6.5
            case "d20":
                return 10.5
            default: return 4.5 // Assume a d8 for all others, as it's the most common
        }
    };

    // Calculate the modifier for any given stat score (expected to typically be between 1-30)
    function modifierForStatScore(statScore) {
        return Math.floor((statScore - 10) / 2) || 0; // Default to 0 for anything invalid
    };

    // Get the defense bonus for each shield
    function shieldDefenseBonusFor(shieldName) {
        switch(shieldName) {
            case "shield_p0": return 2;
            case "shield_p1": return 3;
            case "shield_p2": return 4;
            default: return 0; // Assume no shield if unable to determine
        }
    };

    // Filter the array of key strings from a given dictionary to return just those keys which contain a given substring (e.g. "_mod")
    function filterDictionaryKeysByString(theDictionary, filterString) {
        return Object.keys(theDictionary).filter( (arrayItem) => {
            return arrayItem.indexOf(filterString) > -1; // Only flag 'true' for those where the string contains the specified substring
        });
    };

    // Re-calculating derived attributes

    // Recalculate the modifiers for each stat
    function recalculateStatMods() {
        getAttrs( [
            "str",
            "agi",
            "end",
            "wit",
            "knw",
            "prs"
        ], function(values) {
            setAttrs({
                str_mod: modifierForStatScore(values.str),
                agi_mod: modifierForStatScore(values.agi),
                end_mod: modifierForStatScore(values.end),
                wit_mod: modifierForStatScore(values.wit),
                knw_mod: modifierForStatScore(values.knw),
                prs_mod: modifierForStatScore(values.prs)
            });
        });
    };

    // Recalculate the proficiency bonus
    function recalculateProfBonus() {
        getAttrs( [
            "char_level",
            "char_challenge",
            "char_isnpc"
        ], function(values) {
            var bonus = 0;
            if (values.char_isnpc == 0) {
                bonus = 1 + (Math.ceil(values.char_level / 4));
            } else {
                const challenge = parseFloat(values.char_challenge) || 0.0;
                // Work out the proficiency bonus based on the challenge rating thresholds
                if (challenge >= 29) {
                    bonus = 9
                } else if (challenge >= 25) {
                    bonus = 8
                } else if (challenge >= 21) {
                    bonus = 7
                } else if (challenge >= 17) {
                    bonus = 6
                } else if (challenge >= 13) {
                    bonus = 5
                } else if (challenge >= 9) {
                    bonus = 4
                } else if (challenge >= 5) {
                    bonus = 3
                } else {
                    bonus = 2
                }
            }
            setAttrs({
                prof_bonus: bonus
            });
        });
    };

    // Recalculate which type/size of Hit Dice is relevant
    function recalculateHitDiceType() {
        getAttrs( [
            "char_class",
            "char_size",
            "char_isnpc"
        ], function(values) {
            if (values.char_isnpc == 0) {
                // No action needed - this is set manually for Player Characters
            } else {
                setAttrs({
                    npc_hitdice_type: hitDiceForSize(values.char_size)
                });
            }
        });
    };

    // Recalculate NPC default health
    function recalculateNPCDefaultHealth() {
        getAttrs( [
            "npc_hitdice",
            "npc_hitdice_type",
            "end_mod"
        ], function(values) {
            const avgHP = parseFloat(avgRollForHitDice(values.npc_hitdice_type));
            const endBonus = (parseInt(values.end_mod) || 0) * (parseInt(values.npc_hitdice) || 1);
            const defaultHP = Math.floor((parseInt(values.npc_hitdice) || 1) * avgHP) + endBonus; // Rounding down is the standard
            setAttrs({
                npc_hp_avg: avgHP,
                npc_hp_endbonus: endBonus,
                npc_hp_default: defaultHP
            });
        });
    }

    // Recalculate the Hit Dice max
    function recalculateMaxHitDice() {
        getAttrs( [
            "char_level"
        ], function(values) {
            setAttrs({
                hitdice_max: values.char_level // Max Hit Dice is always equal to level
            });
        });
    };

    // Recalculate the AP max
    function recalculateMaxAP() {
        getAttrs( [
            "char_level",
            "char_challenge",
            "char_isnpc"
        ], function(values) {
            var max = 1;
            if (values.char_isnpc == 0) {
                max = values.char_level // Max AP is always equal to player character level
            } else {
                const challenge = parseFloat(values.char_challenge) || 0.0; // Max AP is determined by NPC challenge rating
                if (challenge < 1) {
                    max = 0; // NPCs with a CR < 1 (including 0.5) don't get AP
                } else {
                    max = parseInt(challenge);
                }
            }
            setAttrs({
                ap_max: max
            });
        });
    };

    // Recalculate the Stun Damage max
    function recalculateMaxStunDamage() {
        getAttrs( [
            "hp"
        ], function(values) {
            setAttrs({
                stundamage_max: values.hp // Stun damage always goes up to the character's current HP
            });
        });
    };

    // Ensure that current AP never exceeds the max
    function capCurrentAP() {
        getAttrs( [
            "ap_max",
            "ap"
        ], function(values) {
            let current_ap = Math.min(values.ap_max, values.ap); // Current shouldn't ever exceed max
            setAttrs({
                ap: current_ap
            });
        });
    };

    // Ensure that current AP never exceeds the max
    function capCurrentHitDice() {
        getAttrs( [
            "hitdice_max",
            "hitdice"
        ], function(values) {
            let current_hitdice = Math.min(values.hitdice_max, values.hitdice); // Current shouldn't ever exceed max
            setAttrs({
                hitdice: current_hitdice
            });
        });
    };

    // Ensure that current HP never exceeds the max
    function capCurrentHP() {
        getAttrs( [
            "hp_max",
            "hp"
        ], function(values) {
            let current_hp = Math.min(values.hp_max, values.hp); // Current shouldn't ever exceed max
            setAttrs({
                hp: current_hp
            });
        });
    };

    // Ensure that current Stun Damage never exceeds the max
    function capCurrentStunDamage() {
        getAttrs( [
            "stundamage_max",
            "stundamage"
        ], function(values) {
            let current_stundamage = Math.min(values.stundamage_max, values.stundamage); // Current shouldn't ever exceed max
            setAttrs({
                stundamage: current_stundamage
            });
        });
    };

    // Recalculate the final defense value
    function recalculateDefense() {
        getAttrs( [
            "armorbase",
            "armorcap",
            "armorextra",
            "armorendbonus",
            "shield",
            "agi_mod",
            "end_mod"
        ], function(values) {
            const baseDef = parseInt(values.armorbase) || 10; // Assume 10 (the foundational defense value) if unable to determine
            const modCap = isNaN(parseInt(values.armorcap)) ? Number.MAX_SAFE_INTEGER : parseInt(values.armorcap); // If unable to get a number from the drop-down, assume it's infinity
            const mod = parseInt(values.agi_mod) || 0;
            const cappedMod = Math.min(mod, modCap); // Use whichever value is lower out of the mod or its cap
            const extra = parseInt(values.armorextra) || 0;
            const enduranceBonus = ((values.armorendbonus == 0) ? 0 : parseInt(values.end_mod) || 0);
            const shieldBonus = shieldDefenseBonusFor(values.shield);
            setAttrs({
                defense: baseDef + cappedMod + extra + shieldBonus + enduranceBonus
            });
        });
    };

    // Recalculate the NPC Determination score
    function recalculateDetermination() {
        getAttrs( [
            "str_mod",
            "agi_mod",
            "end_mod",
            "wit_mod",
            "knw_mod",
            "prs_mod",
            "prof_bonus"
        ], function(values) {
            const maxMod = Math.max( // Work out which bonus is the greatest
                values.str_mod,
                values.agi_mod,
                values.end_mod,
                values.wit_mod,
                values.knw_mod,
                values.prs_mod
            );
            setAttrs({
                npc_determination: 10 + maxMod + values.prof_bonus
            });
        });
    };

    // Recalculate the attack bonus and DC for psi-powers (which is consistent for all)
    function recalculatePowerStats() {
        getAttrs( [
            "wit_mod",
            "prof_bonus"
        ], function(values) {
            const profBonus = parseInt(values.prof_bonus) || 0;
            const witMod = parseInt(values.wit_mod) || 0; // Psi-Powers are always based on WIT
            setAttrs({
                power_attackbonus: witMod + profBonus, // Standard psi-power attack mod calculation
                power_dc: 8 + witMod + profBonus // Standard psi-power DC calculation
            });
        });
    };

    // Calculate the correct modifiers for each skill
    function recalculateSkillMods() {
        getAttrs( [
            "str_mod",
            "agi_mod",
            "end_mod",
            "wit_mod",
            "knw_mod",
            "prs_mod",
            "prof_bonus",
            "athletics_prof",
            "athletics_extra",
            "acrobatics_prof",
            "acrobatics_extra",
            "constitution_prof",
            "constitution_extra",
            "creaturehandling_prof",
            "creaturehandling_extra",
            "deception_prof",
            "deception_extra",
            "driving_prof",
            "driving_extra",
            "evasion_prof",
            "evasion_extra",
            "fasthands_prof",
            "fasthands_extra",
            "history_prof",
            "history_extra",
            "insight_prof",
            "insight_extra",
            "intimidation_prof",
            "intimidation_extra",
            "investigation_prof",
            "investigation_extra",
            "culture_prof",
            "culture_extra",
            "medicine_prof",
            "medicine_extra",
            "mentaldefense_prof",
            "mentaldefense_extra",
            "nature_prof",
            "nature_extra",
            "perception_prof",
            "perception_extra",
            "persuasion_prof",
            "persuasion_extra",
            "psionics_prof",
            "psionics_extra",
            "stealth_prof",
            "stealth_extra",
            "survival_prof",
            "survival_extra",
            "technology_prof",
            "technology_extra"
        ], function(values) {
            let athletics_mod =
                ((values.athletics_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.str_mod) || 0)
                + (parseInt(values.athletics_extra) || 0);
            let acrobatics_mod =
                ((values.acrobatics_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.agi_mod) || 0)
                + (parseInt(values.acrobatics_extra) || 0);
            let constitution_mod =
                ((values.constitution_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.end_mod) || 0)
                + (parseInt(values.constitution_extra) || 0);
            let creaturehandling_mod =
                ((values.creaturehandling_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.creaturehandling_extra) || 0);
            let culture_mod =
                ((values.culture_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.culture_extra) || 0);
            let deception_mod =
                ((values.deception_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.prs_mod) || 0)
                + (parseInt(values.deception_extra) || 0);
            let driving_mod =
                ((values.driving_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.driving_extra) || 0);
            let evasion_mod =
                ((values.evasion_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.agi_mod) || 0)
                + (parseInt(values.evasion_extra) || 0);
            let fasthands_mod =
                ((values.fasthands_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.agi_mod) || 0)
                + (parseInt(values.fasthands_extra) || 0);
            let history_mod =
                ((values.history_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.history_extra) || 0);
            let insight_mod =
                ((values.insight_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.insight_extra) || 0);
            let intimidation_mod =
                ((values.intimidation_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.prs_mod) || 0)
                + (parseInt(values.intimidation_extra) || 0);
            let investigation_mod =
                ((values.investigation_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.investigation_extra) || 0);
            let medicine_mod =
                ((values.medicine_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.medicine_extra) || 0);
            let mentaldefense_mod =
                ((values.mentaldefense_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.mentaldefense_extra) || 0);
            let nature_mod =
                ((values.nature_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.nature_extra) || 0);
            let perception_mod =
                ((values.perception_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.perception_extra) || 0);
            let persuasion_mod =
                ((values.persuasion_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.prs_mod) || 0)
                + (parseInt(values.persuasion_extra) || 0);
            let psionics_mod =
                ((values.psionics_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.psionics_extra) || 0);
            let stealth_mod =
                ((values.stealth_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.agi_mod) || 0)
                + (parseInt(values.stealth_extra) || 0);
            let survival_mod =
                ((values.survival_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.wit_mod) || 0)
                + (parseInt(values.survival_extra) || 0);
            let technology_mod =
                ((values.technology_prof == 0) ? 0 : parseInt(values.prof_bonus) || 0)
                + (parseInt(values.knw_mod) || 0)
                + (parseInt(values.technology_extra) || 0);
            setAttrs({
                athletics_mod: athletics_mod,
                acrobatics_mod: acrobatics_mod,
                constitution_mod: constitution_mod,
                creaturehandling_mod: creaturehandling_mod,
                culture_mod: culture_mod,
                deception_mod: deception_mod,
                driving_mod: driving_mod,
                evasion_mod: evasion_mod,
                fasthands_mod: fasthands_mod,
                history_mod: history_mod,
                insight_mod: insight_mod,
                passive_insight: insight_mod + 10, // Passives have a base of 10
                intimidation_mod: intimidation_mod,
                investigation_mod: investigation_mod,
                medicine_mod: medicine_mod,
                mentaldefense_mod: mentaldefense_mod,
                nature_mod: nature_mod,
                perception_mod: perception_mod,
                persuasion_mod: persuasion_mod,
                passive_perception: perception_mod + 10, // Passives have a base of 10
                psionics_mod: psionics_mod,
                stealth_mod: stealth_mod,
                survival_mod: survival_mod,
                technology_mod: technology_mod
            });
        });
    };

    // Bulk calculations for entire repeating sections
    // These iterate through all rows in a repeating section, tackling each row ID in turn

    function recalculateAllAttacks() {
        getSectionIDs("repeating_attacks", idArray => { // Retrieve all row IDs in the repeating section, and iterate through each one
            idArray.forEach( (element) => {
                const rowID = String(element);
                getAttrs( [
                    "repeating_attacks_" + rowID + "_attack_stat",
                    "repeating_attacks_" + rowID + "_attack_damagestat"
                ], (values) => {
                    // Calculate & apply the attack modifier
                    const attackModName = values["repeating_attacks_" + rowID + "_attack_stat"] + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
                    getAttrs( [
                        "repeating_attacks_" + rowID + "_attack_prof",
                        "repeating_attacks_" + rowID + "_attack_extra",
                        "prof_bonus",
                        attackModName // E.g. "str_mod"
                    ], (values) => {
                        // Calculate & set the final attack modifier, considering all of the contributors
                        const profBonus = parseInt((values["repeating_attacks_" + rowID + "_attack_prof"] == 0) ? 0 : values.prof_bonus) || 0;
                        const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                        const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                        const extraMod = parseInt(values["repeating_attacks_" + rowID + "_attack_extra"]) || 0;
                        const attackMod = profBonus + statMod + extraMod;
                        setAttrs({
                            ["repeating_attacks_" + rowID + "_attack_mod"]: attackMod
                        });
                    });
                    // Calculate & apply the damage calculation & type
                    // WARNING: This needs to be done separately from the attack modifier calculation, because the helper functions must receive only 1 item in 'values' which ends in "_mod" - otherwise, they may pick the wrong one
                    const damageModName = values["repeating_attacks_" + rowID + "_attack_damagestat"] + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
                    getAttrs( [
                        "repeating_attacks_" + rowID + "_attack_damagedicecount",
                        "repeating_attacks_" + rowID + "_attack_damagedicetype",
                        "repeating_attacks_" + rowID + "_attack_damagetype",
                        "repeating_attacks_" + rowID + "_attack_damageextra",
                        damageModName // E.g. "str_mod"
                    ], (values) => {
                        // Calculate & apply the final damage calculation & type, considering all of the contributors
                        const diceCount = parseInt(values["repeating_attacks_" + rowID + "_attack_damagedicecount"]) || 1; // Needs to be at least one die
                        const diceType = values["repeating_attacks_" + rowID + "_attack_damagedicetype"];
                        const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                        const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                        const extraMod = parseInt(values["repeating_attacks_" + rowID + "_attack_damageextra"]) || 0;
                        const damageCalc = "" + diceCount + diceType + " + " + (statMod + extraMod);
                        setAttrs({
                            ["repeating_attacks_" + rowID + "_attack_damagefinalcalc"]: damageCalc,
                            ["repeating_attacks_" + rowID + "_attack_damagefinaltype"]: values["repeating_attacks_" + rowID + "_attack_damagetype"]
                        });
                    });
                });
            });
        });
    };

    function recalculateAllAbilities() {
        getSectionIDs("repeating_abilities", idArray => { // Retrieve all row IDs in the repeating section, and iterate through each one
            idArray.forEach( (element) => {
                const rowID = String(element);
                getAttrs( [
                    "repeating_abilities_" + rowID + "_ability_stat"
                ], (values) => {
                    const modName = values["repeating_abilities_" + rowID + "_ability_stat"] + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
                    getAttrs( [
                        "repeating_abilities_" + rowID + "_ability_rolltype",
                        "prof_bonus",
                        modName // E.g. "str_mod"
                    ], (values) => {
                        const profBonus = parseInt(values.prof_bonus) || 0;
                        const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                        const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                        var finalAmount = 0;
                        switch (values.repeating_abilities_ability_rolltype) {
                            case "attack":
                                finalAmount = statMod + profBonus; // Calculates as an ability attack bonus
                                break;
                            case "difficulty":
                                finalAmount = 8 + statMod + profBonus; // Calculates as an ability DC
                                break;
                            default:
                                finalAmount = 0; // Not relevant
                                break;
                        }
                        setAttrs({
                            ["repeating_abilities_" + rowID + "_ability_mod"]: finalAmount
                        });
                    });
                });
            });
        });
    };

    // Calculations for individual rows in repeating sections (<fieldset>)
    // In order to avoid the need to manually pull row IDs, these functions have been kept within the parent listeners - Roll20 handles them automatically within listeners

    // When ANY attack field changes, even the unrelated ones (to ensure that it's always triggered when a new row is added and the first value specified - Roll20 doesn't have an event for rows being added, because they don't exist until one value is specified)...
    // Recalculate the final modifier & damage for each attack, including all factors
    on("change:repeating_attacks:attack_name change:repeating_attacks:attack_desc change:repeating_attacks:attack_type change:repeating_attacks:attack_ammo change:repeating_attacks:attack_ammo_max change:repeating_attacks:attack_ammotracked change:repeating_attacks:attack_ammoreloads change:repeating_attacks:attack_prof change:repeating_attacks:attack_stat change:repeating_attacks:attack_extra change:repeating_attacks:attack_damagedicecount change:repeating_attacks:attack_damagedicetype change:repeating_attacks:attack_damagestat change:repeating_attacks:attack_damageextra change:repeating_attacks:attack_damagetype", function(eventInfo) {
        getAttrs( [
            "repeating_attacks_attack_stat",
            "repeating_attacks_attack_damagestat"
        ], (values) => {
            // Calculate and apply the attack modifier
            const attackModName = values.repeating_attacks_attack_stat + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
            getAttrs( [
                "repeating_attacks_attack_prof",
                "repeating_attacks_attack_extra",
                "prof_bonus",
                attackModName // E.g. "str_mod"
            ], (values) => {
                // Calculate & set the final attack modifier, considering all of the contributors
                const profBonus = parseInt((values.repeating_attacks_attack_prof == 0) ? 0 : values.prof_bonus) || 0;
                const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                const extraMod = parseInt(values.repeating_attacks_attack_extra) || 0;
                const attackMod = profBonus + statMod + extraMod;
                setAttrs({
                    repeating_attacks_attack_mod: attackMod
                });
            });
            // Calculate & apply the damage calculation & type
            // WARNING: This needs to be done separately from the attack modifier calculation, because the helper functions must receive only 1 item in 'values' which ends in "_mod" - otherwise, they may pick the wrong one
            const damageModName = values.repeating_attacks_attack_damagestat + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
            getAttrs( [
                "repeating_attacks_attack_damagedicecount",
                "repeating_attacks_attack_damagedicetype",
                "repeating_attacks_attack_damagetype",
                "repeating_attacks_attack_damageextra",
                damageModName // E.g. "str_mod"
            ], (values) => {
                // Calculate & apply the final damage calculation & type, considering all of the contributors
                const diceCount = parseInt(values.repeating_attacks_attack_damagedicecount) || 1; // Needs to be at least one die
                const diceType = values.repeating_attacks_attack_damagedicetype;
                const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                const extraMod = parseInt(values.repeating_attacks_attack_damageextra) || 0;
                const damageCalc = diceCount + diceType + " + " + (statMod + extraMod);
                setAttrs({
                    repeating_attacks_attack_damagefinalcalc: damageCalc,
                    repeating_attacks_attack_damagefinaltype: values.repeating_attacks_attack_damagetype
                });
            });
        });
    });

    // When the ammo amount or max amount of any attack changes...
    // Ensure that the amounts are capped appropriately
    on("change:repeating_attacks:attack_ammo change:repeating_attacks:attack_ammo_max", function() {
        getAttrs( [
            "repeating_attacks_attack_ammo",
            "repeating_attacks_attack_ammo_max"
        ], (values) => {
            let capped_ammo = Math.min(values.repeating_attacks_attack_ammo, values.repeating_attacks_attack_ammo_max); // Amount shouldn't ever exceed max
            setAttrs({
                repeating_attacks_attack_ammo: capped_ammo
            });
        });
    });

    // When ANY ability field changes, even the unrelated ones (to ensure that it's always triggered when a new row is added and the first value specified - Roll20 doesn't have an event for rows being added, because they don't exist until one value is specified)...
    // Recalculate the final modifier for each ability, including all factors
    on("change:repeating_abilities:ability_name change:repeating_abilities:ability_stat change:repeating_abilities:ability_desc change:repeating_abilities:ability_apcost change:repeating_abilities:attack_target change:repeating_abilities:attack_range change:repeating_abilities:ability_chargeup change:repeating_abilities:ability_duration change:repeating_abilities:ability_concentration change:repeating_abilities:ability_rolltype change:repeating_abilities:ability_mod", function() {
        getAttrs( [
            "repeating_abilities_ability_stat"
        ], (values) => {
            const modName = values.repeating_abilities_ability_stat + "_mod"; // Assemble the corresponding mod field name from the name of the selected stat (e.g. "str_mod")
            getAttrs( [
                "repeating_abilities_ability_rolltype",
                "prof_bonus",
                modName // E.g. "str_mod"
            ], (values) => {
                const profBonus = parseInt(values.prof_bonus) || 0;
                const statModKey = filterDictionaryKeysByString(values, "_mod")[0]; // Work out the name of the modifier's key, to allow retrieval from the values dictionary - seeing as only one key should match, just take the first value
                const statMod = parseInt(values[statModKey]) || 0; // Retrieve the corresponding value using the derived key
                var finalAmount = 0;
                switch (values.repeating_abilities_ability_rolltype) {
                    case "attack":
                        finalAmount = statMod + profBonus; // Calculates as an ability attack bonus
                        break;
                    case "difficulty":
                        finalAmount = 8 + statMod + profBonus; // Calculates as an ability DC
                        break;
                    default:
                        finalAmount = 0; // Not relevant
                        break;
                }
                setAttrs({
                    repeating_abilities_ability_mod: finalAmount
                });
            });
        });
    });

    // When the amount or max amount of any technique changes...
    // Ensure that the amounts are capped appropriately
    on("change:repeating_techniques:technique_amount change:repeating_techniques:technique_max", function() {
        getAttrs( [
            "repeating_techniques_technique_amount",
            "repeating_techniques_technique_max"
        ], (values) => {
            let capped_amount = Math.min(values.repeating_techniques_technique_amount, values.repeating_techniques_technique_max); // Amount shouldn't ever exceed max
            setAttrs({
                repeating_techniques_technique_amount: capped_amount
            });
        });
    });

    // When the amount or max amount of any inventory item changes...
    // Ensure that the amounts are capped appropriately
    on("change:repeating_inventory:inventory_amount change:repeating_inventory:inventory_amount_max", function() {
        getAttrs( [
            "repeating_inventory_inventory_amount",
            "repeating_inventory_inventory_amount_max"
        ], (values) => {
            let capped_amount = Math.min(values.repeating_inventory_inventory_amount, values.repeating_inventory_inventory_amount_max); // Amount shouldn't ever exceed max
            setAttrs({
                repeating_inventory_inventory_amount: capped_amount
            });
        });
    });

    // Listeners for key field changes

    // When the character's level is changed
    on("change:char_level change:char_challenge change:char_isnpc", function() {
        recalculateProfBonus();
        recalculateMaxAP();
        recalculateMaxHitDice();
    });

    // When the character's class is changed
    on("change:char_class change:char_size change:char_isnpc", function() {
        recalculateHitDiceType()
    });

    // When anything related to the NPC hit dice changes
    on("change:npc_hitdice change:npc_hitdice_type change:end_mod change:char_challenge change:char_isnpc", function() {
        recalculateNPCDefaultHealth()
    });

    // When any of the stats are changed
    on("change:str change:agi change:end change:wit change:knw change:prs", function() {
        recalculateStatMods();
    });

    // When the character's proficiency bonus is changed
    on("change:prof_bonus", function() {
        recalculateSkillMods();
        recalculatePowerStats();
        recalculateDetermination();
        recalculateAllAttacks();
        recalculateAllAbilities();
    });

    // When any of the stat modifiers are changed
    on("change:str_mod change:agi_mod change:end_mod change:wit_mod change:knw_mod change:prs_mod", function() {
        recalculateSkillMods();
        recalculatePowerStats();
        recalculateAllAttacks();
        recalculateAllAbilities();
    });

    // When the max or current HP changes
    on("change:hp_max change:hp", function() {
        capCurrentHP();
        recalculateMaxStunDamage();
    });

    // When the max or current Hit Dice changes
    on("change:hitdice_max change:hitdice", function() {
        capCurrentHitDice();
    });

    // When the max or current AP changes
    on("change:ap_max change:ap", function() {
        capCurrentAP();
    });

    // When the max or current Stun Damage changes
    on("change:stundamage_max change:stundamage", function() {
        capCurrentStunDamage();
    });

    // When any skill proficiencies change
    on("change:athletics_prof change:acrobatics_prof change:constitution_prof change:creaturehandling_prof change:culture_prof change:deception_prof change:driving_prof change:evasion_prof change:fasthands_prof change:history_prof change:insight_prof change:intimidation_prof change:investigation_prof change:medicine_prof change:mentaldefense_prof change:nature_prof change:perception_prof change:persuasion_prof change:psionics_prof change:stealth_prof change:survival_prof change:technology_prof", function() {
        recalculateSkillMods();
    });

    // When any skill extra bonuses change
    on("change:athletics_extra change:acrobatics_extra change:constitution_extra change:creaturehandling_extra change:culture_extra change:deception_extra change:driving_extra change:evasion_extra change:fasthands_extra change:history_extra change:insight_extra change:intimidation_extra change:investigation_extra change:medicine_extra change:mentaldefense_extra change:nature_extra change:perception_extra change:persuasion_extra change:psionics_extra change:stealth_extra change:survival_extra change:technology_extra", function() {
        recalculateSkillMods();
    });

    // When anything related to armor class changes
    on("change:armorbase change:armorcap change:armorextra change:armorendbonus change:shield change:agi_mod change:end_mod", function() {
        recalculateDefense();
    });

    // When the sheet opens
    on("sheet:opened", function() {
        recalculateStatMods();
        recalculateProfBonus();
        recalculateSkillMods();
        recalculateMaxAP();
        recalculateMaxStunDamage();
        recalculateHitDiceType();
        recalculateNPCDefaultHealth();
        recalculateMaxHitDice();
        recalculateDefense();
        recalculatePowerStats();
        recalculateDetermination();
        recalculateAllAttacks();
        recalculateAllAbilities();
    });

</script>

</html>